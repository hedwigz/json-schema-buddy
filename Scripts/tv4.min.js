(function(n,t){typeof define=="function"&&define.amd?define([],t):typeof module!="undefined"&&module.exports?module.exports=t():n.tv4=t()})(this,function(){function o(n){return encodeURI(n).replace(/%25[0-9][0-9]/g,function(n){return"%"+n.substring(3)})}function g(n){var i="",s,t,c,l,a,v,y;p[n.charAt(0)]&&(i=n.charAt(0),n=n.substring(1));var r="",u="",e=!0,f=!1,b=!1;i==="+"?e=!1:i==="."?(u=".",r="."):i==="/"?(u="/",r="/"):i==="#"?(u="#",e=!1):i===";"?(u=";",r=";",f=!0,b=!0):i==="?"?(u="?",r="&",f=!0):i==="&"&&(u="&",r="&",f=!0);var k=[],d=n.split(","),h=[],g={};for(s=0;s<d.length;s++){for(t=d[s],c=null,t.indexOf(":")!==-1&&(l=t.split(":"),t=l[0],c=parseInt(l[1],10)),a={};w[t.charAt(t.length-1)];)a[t.charAt(t.length-1)]=!0,t=t.substring(0,t.length-1);v={truncate:c,name:t,suffices:a};h.push(v);g[t]=v;k.push(t)}return y=function(n){for(var s,t,c,v,l,i="",y=0,a=0;a<h.length;a++){if(s=h[a],t=n(s.name),t===null||t===undefined||Array.isArray(t)&&t.length===0||typeof t=="object"&&Object.keys(t).length===0){y++;continue}if(i+=a===y?u:r||",",Array.isArray(t))for(f&&(i+=s.name+"="),c=0;c<t.length;c++)c>0&&(i+=s.suffices["*"]?r||",":",",s.suffices["*"]&&f&&(i+=s.name+"=")),i+=e?encodeURIComponent(t[c]).replace(/!/g,"%21"):o(t[c]);else if(typeof t=="object"){f&&!s.suffices["*"]&&(i+=s.name+"=");v=!0;for(l in t)v||(i+=s.suffices["*"]?r||",":","),v=!1,i+=e?encodeURIComponent(l).replace(/!/g,"%21"):o(l),i+=s.suffices["*"]?"=":",",i+=e?encodeURIComponent(t[l]).replace(/!/g,"%21"):o(t[l])}else f&&(i+=s.name,b&&t===""||(i+="=")),s.truncate!=null&&(t=t.substring(0,s.truncate)),i+=e?encodeURIComponent(t).replace(/!/g,"%21"):o(t)}return i},y.varNames=k,{prefix:u,substitution:y}}function s(n){if(!(this instanceof s))return new s(n);for(var t=n.split("{"),i=[t.shift()],h=[],r=[],u=[];t.length>0;){var e=t.shift(),o=e.split("}")[0],c=e.substring(o.length+1),f=g(o);r.push(f.substitution);h.push(f.prefix);i.push(c);u=u.concat(f.substitution.varNames)}this.fill=function(n){for(var f,u=i[0],t=0;t<r.length;t++)f=r[t],u+=f(n),u+=i[t+1];return u};this.varNames=u;this.template=n}function h(n,t){var r,i;if(n===t)return!0;if(n&&t&&typeof n=="object"&&typeof t=="object"){if(Array.isArray(n)!==Array.isArray(t))return!1;if(Array.isArray(n)){if(n.length!==t.length)return!1;for(r=0;r<n.length;r++)if(!h(n[r],t[r]))return!1}else{for(i in n)if(t[i]===undefined&&n[i]!==undefined)return!1;for(i in t)if(n[i]===undefined&&t[i]!==undefined)return!1;for(i in n)if(!h(n[i],t[i]))return!1}return!0}return!1}function k(n){var t=String(n).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null}function v(n,t){function i(n){var t=[];return n.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(n){n==="/.."?t.pop():t.push(n)}),t.join("").replace(/^\//,n.charAt(0)==="/"?"/":"")}return t=k(t||""),n=k(n||""),!t||!n?null:(t.protocol||n.protocol)+(t.protocol||t.authority?t.authority:n.authority)+i(t.protocol||t.authority||t.pathname.charAt(0)==="/"?t.pathname:t.pathname?(n.authority&&!n.pathname?"/":"")+n.pathname.slice(0,n.pathname.lastIndexOf("/")+1)+t.pathname:n.pathname)+(t.protocol||t.authority||t.pathname?t.search:t.search||n.search)+t.hash}function c(n){return n.split("#")[0]}function l(n,t){var i,r;if(n&&typeof n=="object")if(t===undefined?t=n.id:typeof n.id=="string"&&(t=v(t,n.id),n.id=t),Array.isArray(n))for(i=0;i<n.length;i++)l(n[i],t);else{typeof n.$ref=="string"&&(n.$ref=v(t,n.$ref));for(r in n)r!=="enum"&&l(n[r],t)}}function r(n,t,i,r,u,f){if(Error.call(this),n===undefined)throw new Error("No code supplied for error: "+t);this.message=t;this.params=i;this.code=n;this.dataPath=r||"";this.schemaPath=u||"";this.subErrors=f||null;var e=new Error(this.message);if(this.stack=e.stack||e.stacktrace,!this.stack)try{throw e;}catch(e){this.stack=e.stack||e.stacktrace}}function nt(n,t){if(t.substring(0,n.length)===n){var i=t.substring(n.length);if(t.length>0&&t.charAt(n.length-1)==="/"||i.charAt(0)==="#"||i.charAt(0)==="?")return!0}return!1}function d(r){var e=new n,o=r||"en";return{addFormat:function(){e.addFormat.apply(e,arguments)},language:function(n){return n?(i[n]||(n=n.split("-")[0]),i[n])?(o=n,n):!1:o},addLanguage:function(n,r){var u,f;for(u in t)r[u]&&!r[t[u]]&&(r[t[u]]=r[u]);if(f=n.split("-")[0],i[f]){i[n]=Object.create(i[f]);for(u in r)typeof i[f][u]=="undefined"&&(i[f][u]=r[u]),i[n][u]=r[u]}else i[n]=r,i[f]=r;return this},freshApi:function(n){var t=d();return n&&t.language(n),t},validate:function(t,r,u,f){var h=new n(e,!1,i[o],u,f),s;return typeof r=="string"&&(r={$ref:r}),h.addSchema("",r),s=h.validateAll(t,r,null,null,""),!s&&f&&(s=h.banUnknownProperties()),this.error=s,this.missing=h.missing,this.valid=s===null,this.valid},validateResult:function(){var n={};return this.validate.apply(n,arguments),n},validateMultiple:function(t,r,u,f){var h=new n(e,!0,i[o],u,f),s;return typeof r=="string"&&(r={$ref:r}),h.addSchema("",r),h.validateAll(t,r,null,null,""),f&&h.banUnknownProperties(),s={},s.errors=h.errors,s.missing=h.missing,s.valid=s.errors.length===0,s},addSchema:function(){return e.addSchema.apply(e,arguments)},getSchema:function(){return e.getSchema.apply(e,arguments)},getSchemaMap:function(){return e.getSchemaMap.apply(e,arguments)},getSchemaUris:function(){return e.getSchemaUris.apply(e,arguments)},getMissingUris:function(){return e.getMissingUris.apply(e,arguments)},dropSchemas:function(){e.dropSchemas.apply(e,arguments)},defineKeyword:function(){e.defineKeyword.apply(e,arguments)},defineError:function(n,r,e){var s,o;if(typeof n!="string"||!/^[A-Z]+(_[A-Z]+)*$/.test(n))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if(typeof r!="number"||r%1!=0||r<1e4)throw new Error("Code number must be an integer > 10000");if(typeof t[n]!="undefined")throw new Error("Error already defined: "+n+" as "+t[n]);if(typeof u[r]!="undefined")throw new Error("Error code already used: "+u[r]+" as "+r);t[n]=r;u[r]=n;f[n]=f[r]=e;for(s in i)o=i[s],o[n]&&(o[r]=o[r]||o[n])},reset:function(){e.reset();this.error=null;this.missing=[];this.valid=!0},missing:[],error:null,valid:!0,normSchema:l,resolveUrl:v,getDocumentUri:c,errorCodes:t}}var p,w,n,a,b,t,u,y,f,i,e;Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(u){var e,o,f;if(typeof u!="object"&&typeof u!="function"||u===null)throw new TypeError("Object.keys called on non-object");e=[];for(o in u)t.call(u,o)&&e.push(o);if(i)for(f=0;f<r;f++)t.call(u,n[f])&&e.push(n[f]);return e}}());Object.create||(Object.create=function(){function n(){}return function(t){if(arguments.length!==1)throw new Error("Object.create implementation only accepts one parameter.");return n.prototype=t,new n}}());Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"});Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var u,r,t,i;if(this===null)throw new TypeError;if((u=Object(this),r=u.length>>>0,r===0)||(t=0,arguments.length>1&&(t=Number(arguments[1]),t!==t?t=0:t!==0&&t!==Infinity&&t!==-Infinity&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=r))return-1;for(i=t>=0?t:Math.max(r-Math.abs(t),0);i<r;i++)if(i in u&&u[i]===n)return i;return-1});Object.isFrozen||(Object.isFrozen=function(n){for(var t="tv4_test_frozen_key";n.hasOwnProperty(t);)t+=Math.random();try{return n[t]=!0,delete n[t],!1}catch(i){return!0}});p={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0};w={"*":!0};s.prototype={toString:function(){return this.template},fillFromObject:function(n){return this.fill(function(t){return n[t]})}};n=function(n,t,i,r,u){if(this.missing=[],this.missingMap={},this.formatValidators=n?Object.create(n.formatValidators):{},this.schemas=n?Object.create(n.schemas):{},this.collectMultiple=t,this.errors=[],this.handleError=t?this.collectError:this.returnError,r&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),u&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=i,this.definedKeywords={},n)for(var f in n.definedKeywords)this.definedKeywords[f]=n.definedKeywords[f].slice(0)};n.prototype.defineKeyword=function(n,t){this.definedKeywords[n]=this.definedKeywords[n]||[];this.definedKeywords[n].push(t)};n.prototype.createError=function(n,t,i,u,e){var o=this.errorMessages[n]||f[n],s;return typeof o!="string"?new r(n,"Unknown error code "+n+": "+JSON.stringify(t),t,i,u,e):(s=o.replace(/\{([^{}]*)\}/g,function(n,i){var r=t[i];return typeof r=="string"||typeof r=="number"?r:n}),new r(n,s,t,i,u,e))};n.prototype.returnError=function(n){return n};n.prototype.collectError=function(n){return n&&this.errors.push(n),null};n.prototype.prefixErrors=function(n,t,i){for(var r=n;r<this.errors.length;r++)this.errors[r]=this.errors[r].prefixWith(t,i);return this};n.prototype.banUnknownProperties=function(){var n,r,i;for(n in this.unknownPropertyPaths)if(r=this.createError(t.UNKNOWN_PROPERTY,{path:n},n,""),i=this.handleError(r),i)return i;return null};n.prototype.addFormat=function(n,t){if(typeof n=="object"){for(var i in n)this.addFormat(i,n[i]);return this}this.formatValidators[n]=t};n.prototype.resolveRefs=function(n,i){if(n.$ref!==undefined){if(i=i||{},i[n.$ref])return this.createError(t.CIRCULAR_REFERENCE,{urls:Object.keys(i).join(", ")},"","");i[n.$ref]=!0;n=this.getSchema(n.$ref,i)}return n};n.prototype.getSchema=function(n,t){var i,r,e,u,o,f,s;if(this.schemas[n]!==undefined)return i=this.schemas[n],this.resolveRefs(i,t);if(r=n,e="",n.indexOf("#")!==-1&&(e=n.substring(n.indexOf("#")+1),r=n.substring(0,n.indexOf("#"))),typeof this.schemas[r]=="object"){if(i=this.schemas[r],u=decodeURIComponent(e),u==="")return this.resolveRefs(i,t);if(u.charAt(0)!=="/")return undefined;for(o=u.split("/").slice(1),f=0;f<o.length;f++){if(s=o[f].replace(/~1/g,"/").replace(/~0/g,"~"),i[s]===undefined){i=undefined;break}i=i[s]}if(i!==undefined)return this.resolveRefs(i,t)}this.missing[r]===undefined&&(this.missing.push(r),this.missing[r]=r,this.missingMap[r]=r)};n.prototype.searchSchemas=function(n,t){var u,i,r;if(Array.isArray(n))for(u=0;u<n.length;u++)this.searchSchemas(n[u],t);else if(n&&typeof n=="object"){typeof n.id=="string"&&nt(t,n.id)&&this.schemas[n.id]===undefined&&(this.schemas[n.id]=n);for(i in n)i!=="enum"&&(typeof n[i]=="object"?this.searchSchemas(n[i],t):i==="$ref"&&(r=c(n[i]),r&&this.schemas[r]===undefined&&this.missingMap[r]===undefined&&(this.missingMap[r]=r)))}};n.prototype.addSchema=function(n,t){if(typeof n!="string"||typeof t=="undefined")if(typeof n=="object"&&typeof n.id=="string")t=n,n=t.id;else return;n===c(n)+"#"&&(n=c(n));this.schemas[n]=t;delete this.missingMap[n];l(t,n);this.searchSchemas(t,n)};n.prototype.getSchemaMap=function(){var n={};for(var t in this.schemas)n[t]=this.schemas[t];return n};n.prototype.getSchemaUris=function(n){var t=[];for(var i in this.schemas)(!n||n.test(i))&&t.push(i);return t};n.prototype.getMissingUris=function(n){var t=[];for(var i in this.missingMap)(!n||n.test(i))&&t.push(i);return t};n.prototype.dropSchemas=function(){this.schemas={};this.reset()};n.prototype.reset=function(){this.missing=[];this.missingMap={};this.errors=[]};n.prototype.validateAll=function(n,t,i,u,f){var p,c,l,a,o,b,v,y;if(t=this.resolveRefs(t),t){if(t instanceof r)return this.errors.push(t),t}else return null;var w=this.errors.length,e,s=null,h=null;if(this.checkRecursive&&n&&typeof n=="object"){if(p=!this.scanned.length,n[this.validatedSchemasKey]&&(c=n[this.validatedSchemasKey].indexOf(t),c!==-1))return this.errors=this.errors.concat(n[this.validationErrorsKey][c]),null;if(Object.isFrozen(n)&&(e=this.scannedFrozen.indexOf(n),e!==-1&&(l=this.scannedFrozenSchemas[e].indexOf(t),l!==-1)))return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[e][l]),null;if(this.scanned.push(n),Object.isFrozen(n))e===-1&&(e=this.scannedFrozen.length,this.scannedFrozen.push(n),this.scannedFrozenSchemas.push([])),s=this.scannedFrozenSchemas[e].length,this.scannedFrozenSchemas[e][s]=t,this.scannedFrozenValidationErrors[e][s]=[];else{if(!n[this.validatedSchemasKey])try{Object.defineProperty(n,this.validatedSchemasKey,{value:[],configurable:!0});Object.defineProperty(n,this.validationErrorsKey,{value:[],configurable:!0})}catch(k){n[this.validatedSchemasKey]=[];n[this.validationErrorsKey]=[]}h=n[this.validatedSchemasKey].length;n[this.validatedSchemasKey][h]=t;n[this.validationErrorsKey][h]=[]}}if(a=this.errors.length,o=this.validateBasic(n,t,f)||this.validateNumeric(n,t,f)||this.validateString(n,t,f)||this.validateArray(n,t,f)||this.validateObject(n,t,f)||this.validateCombinations(n,t,f)||this.validateHypermedia(n,t,f)||this.validateFormat(n,t,f)||this.validateDefinedKeywords(n,t,f)||null,p){while(this.scanned.length)b=this.scanned.pop(),delete b[this.validatedSchemasKey];this.scannedFrozen=[];this.scannedFrozenSchemas=[]}if(o||a!==this.errors.length)while(i&&i.length||u&&u.length)v=i&&i.length?""+i.pop():null,y=u&&u.length?""+u.pop():null,o&&(o=o.prefixWith(v,y)),this.prefixErrors(a,v,y);return s!==null?this.scannedFrozenValidationErrors[e][s]=this.errors.slice(w):h!==null&&(n[this.validationErrorsKey][h]=this.errors.slice(w)),this.handleError(o)};n.prototype.validateFormat=function(n,i){if(typeof i.format!="string"||!this.formatValidators[i.format])return null;var r=this.formatValidators[i.format].call(null,n,i);return typeof r=="string"||typeof r=="number"?this.createError(t.FORMAT_CUSTOM,{message:r}).prefixWith(null,"format"):r&&typeof r=="object"?this.createError(t.FORMAT_CUSTOM,{message:r.message||"?"},r.dataPath||null,r.schemaPath||"/format"):null};n.prototype.validateDefinedKeywords=function(n,i,r){var e,s,o,h,u,f,c,l;for(e in this.definedKeywords)if(typeof i[e]!="undefined")for(s=this.definedKeywords[e],o=0;o<s.length;o++){if(h=s[o],u=h(n,i[e],i,r),typeof u=="string"||typeof u=="number")return this.createError(t.KEYWORD_CUSTOM,{key:e,message:u}).prefixWith(null,"format");if(u&&typeof u=="object"){if(f=u.code,typeof f=="string"){if(!t[f])throw new Error("Undefined error code (use defineError): "+f);f=t[f]}else typeof f!="number"&&(f=t.KEYWORD_CUSTOM);return c=typeof u.message=="object"?u.message:{key:e,message:u.message||"?"},l=u.schemaPath||"/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),this.createError(f,c,u.dataPath||null,l)}}return null};n.prototype.validateBasic=function(n,t,i){var r;return(r=this.validateType(n,t,i))?r.prefixWith(null,"type"):(r=this.validateEnum(n,t,i))?r.prefixWith(null,"type"):null};n.prototype.validateType=function(n,i){var u,r,f,e;if(i.type===undefined)return null;for(u=typeof n,n===null?u="null":Array.isArray(n)&&(u="array"),r=i.type,typeof r!="object"&&(r=[r]),f=0;f<r.length;f++)if(e=r[f],e===u||e==="integer"&&u==="number"&&n%1==0)return null;return this.createError(t.INVALID_TYPE,{type:u,expected:r.join("/")})};n.prototype.validateEnum=function(n,i){var r,u;if(i["enum"]===undefined)return null;for(r=0;r<i["enum"].length;r++)if(u=i["enum"][r],h(n,u))return null;return this.createError(t.ENUM_MISMATCH,{value:typeof JSON!="undefined"?JSON.stringify(n):n})};n.prototype.validateNumeric=function(n,t,i){return this.validateMultipleOf(n,t,i)||this.validateMinMax(n,t,i)||this.validateNaN(n,t,i)||null};a=Math.pow(2,-51);b=1-a;n.prototype.validateMultipleOf=function(n,i){var r=i.multipleOf||i.divisibleBy,u;return r===undefined?null:typeof n=="number"&&(u=n/r%1,u>=a&&u<b)?this.createError(t.NUMBER_MULTIPLE_OF,{value:n,multipleOf:r}):null};n.prototype.validateMinMax=function(n,i){if(typeof n!="number")return null;if(i.minimum!==undefined){if(n<i.minimum)return this.createError(t.NUMBER_MINIMUM,{value:n,minimum:i.minimum}).prefixWith(null,"minimum");if(i.exclusiveMinimum&&n===i.minimum)return this.createError(t.NUMBER_MINIMUM_EXCLUSIVE,{value:n,minimum:i.minimum}).prefixWith(null,"exclusiveMinimum")}if(i.maximum!==undefined){if(n>i.maximum)return this.createError(t.NUMBER_MAXIMUM,{value:n,maximum:i.maximum}).prefixWith(null,"maximum");if(i.exclusiveMaximum&&n===i.maximum)return this.createError(t.NUMBER_MAXIMUM_EXCLUSIVE,{value:n,maximum:i.maximum}).prefixWith(null,"exclusiveMaximum")}return null};n.prototype.validateNaN=function(n){return typeof n!="number"?null:isNaN(n)===!0||n===Infinity||n===-Infinity?this.createError(t.NUMBER_NOT_A_NUMBER,{value:n}).prefixWith(null,"type"):null};n.prototype.validateString=function(n,t,i){return this.validateStringLength(n,t,i)||this.validateStringPattern(n,t,i)||null};n.prototype.validateStringLength=function(n,i){return typeof n!="string"?null:i.minLength!==undefined&&n.length<i.minLength?this.createError(t.STRING_LENGTH_SHORT,{length:n.length,minimum:i.minLength}).prefixWith(null,"minLength"):i.maxLength!==undefined&&n.length>i.maxLength?this.createError(t.STRING_LENGTH_LONG,{length:n.length,maximum:i.maxLength}).prefixWith(null,"maxLength"):null};n.prototype.validateStringPattern=function(n,i){if(typeof n!="string"||i.pattern===undefined)return null;var r=new RegExp(i.pattern);return r.test(n)?null:this.createError(t.STRING_PATTERN,{pattern:i.pattern}).prefixWith(null,"pattern")};n.prototype.validateArray=function(n,t,i){return Array.isArray(n)?this.validateArrayLength(n,t,i)||this.validateArrayUniqueItems(n,t,i)||this.validateArrayItems(n,t,i)||null:null};n.prototype.validateArrayLength=function(n,i){var r;return i.minItems!==undefined&&n.length<i.minItems&&(r=this.createError(t.ARRAY_LENGTH_SHORT,{length:n.length,minimum:i.minItems}).prefixWith(null,"minItems"),this.handleError(r))?r:i.maxItems!==undefined&&n.length>i.maxItems&&(r=this.createError(t.ARRAY_LENGTH_LONG,{length:n.length,maximum:i.maxItems}).prefixWith(null,"maxItems"),this.handleError(r))?r:null};n.prototype.validateArrayUniqueItems=function(n,i){var r,u,f;if(i.uniqueItems)for(r=0;r<n.length;r++)for(u=r+1;u<n.length;u++)if(h(n[r],n[u])&&(f=this.createError(t.ARRAY_UNIQUE,{match1:r,match2:u}).prefixWith(null,"uniqueItems"),this.handleError(f)))return f;return null};n.prototype.validateArrayItems=function(n,i,r){if(i.items===undefined)return null;var f,u;if(Array.isArray(i.items)){for(u=0;u<n.length;u++)if(u<i.items.length){if(f=this.validateAll(n[u],i.items[u],[u],["items",u],r+"/"+u))return f}else if(i.additionalItems!==undefined)if(typeof i.additionalItems=="boolean"){if(!i.additionalItems&&(f=this.createError(t.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+u,"additionalItems"),this.handleError(f)))return f}else if(f=this.validateAll(n[u],i.additionalItems,[u],["additionalItems"],r+"/"+u))return f}else for(u=0;u<n.length;u++)if(f=this.validateAll(n[u],i.items,[u],["items"],r+"/"+u))return f;return null};n.prototype.validateObject=function(n,t,i){return typeof n!="object"||n===null||Array.isArray(n)?null:this.validateObjectMinMaxProperties(n,t,i)||this.validateObjectRequiredProperties(n,t,i)||this.validateObjectProperties(n,t,i)||this.validateObjectDependencies(n,t,i)||null};n.prototype.validateObjectMinMaxProperties=function(n,i){var u=Object.keys(n),r;return i.minProperties!==undefined&&u.length<i.minProperties&&(r=this.createError(t.OBJECT_PROPERTIES_MINIMUM,{propertyCount:u.length,minimum:i.minProperties}).prefixWith(null,"minProperties"),this.handleError(r))?r:i.maxProperties!==undefined&&u.length>i.maxProperties&&(r=this.createError(t.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:u.length,maximum:i.maxProperties}).prefixWith(null,"maxProperties"),this.handleError(r))?r:null};n.prototype.validateObjectRequiredProperties=function(n,i){var r,u,f;if(i.required!==undefined)for(r=0;r<i.required.length;r++)if(u=i.required[r],n[u]===undefined&&(f=this.createError(t.OBJECT_REQUIRED,{key:u}).prefixWith(null,""+r).prefixWith(null,"required"),this.handleError(f)))return f;return null};n.prototype.validateObjectProperties=function(n,i,r){var e,u,f,o,s,h;for(u in n){if(f=r+"/"+u.replace(/~/g,"~0").replace(/\//g,"~1"),o=!1,i.properties!==undefined&&i.properties[u]!==undefined&&(o=!0,e=this.validateAll(n[u],i.properties[u],[u],["properties",u],f)))return e;if(i.patternProperties!==undefined)for(s in i.patternProperties)if(h=new RegExp(s),h.test(u)&&(o=!0,e=this.validateAll(n[u],i.patternProperties[s],[u],["patternProperties",s],f)))return e;if(o)this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]);else if(i.additionalProperties!==undefined){if(this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]),typeof i.additionalProperties=="boolean"){if(!i.additionalProperties&&(e=this.createError(t.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(u,"additionalProperties"),this.handleError(e)))return e}else if(e=this.validateAll(n[u],i.additionalProperties,[u],["additionalProperties"],f))return e}else this.trackUnknownProperties&&!this.knownPropertyPaths[f]&&(this.unknownPropertyPaths[f]=!0)}return null};n.prototype.validateObjectDependencies=function(n,i,r){var u,f,e,o,s;if(i.dependencies!==undefined)for(f in i.dependencies)if(n[f]!==undefined)if(e=i.dependencies[f],typeof e=="string"){if(n[e]===undefined&&(u=this.createError(t.OBJECT_DEPENDENCY_KEY,{key:f,missing:e}).prefixWith(null,f).prefixWith(null,"dependencies"),this.handleError(u)))return u}else if(Array.isArray(e)){for(o=0;o<e.length;o++)if(s=e[o],n[s]===undefined&&(u=this.createError(t.OBJECT_DEPENDENCY_KEY,{key:f,missing:s}).prefixWith(null,""+o).prefixWith(null,f).prefixWith(null,"dependencies"),this.handleError(u)))return u}else if(u=this.validateAll(n,e,[],["dependencies",f],r))return u;return null};n.prototype.validateCombinations=function(n,t,i){return this.validateAllOf(n,t,i)||this.validateAnyOf(n,t,i)||this.validateOneOf(n,t,i)||this.validateNot(n,t,i)||null};n.prototype.validateAllOf=function(n,t,i){var u,r,f;if(t.allOf===undefined)return null;for(r=0;r<t.allOf.length;r++)if(f=t.allOf[r],u=this.validateAll(n,f,[],["allOf",r],i))return u;return null};n.prototype.validateAnyOf=function(n,i,r){var f,e,o,s,h,u,l,a;if(i.anyOf===undefined)return null;for(f=[],e=this.errors.length,this.trackUnknownProperties&&(o=this.unknownPropertyPaths,s=this.knownPropertyPaths),h=!0,u=0;u<i.anyOf.length;u++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var v=i.anyOf[u],y=this.errors.length,c=this.validateAll(n,v,[],["anyOf",u],r);if(c===null&&y===this.errors.length){if(this.errors=this.errors.slice(0,e),this.trackUnknownProperties){for(l in this.knownPropertyPaths)s[l]=!0,delete o[l];for(a in this.unknownPropertyPaths)s[a]||(o[a]=!0);h=!1;continue}return null}c&&f.push(c.prefixWith(null,""+u).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=o,this.knownPropertyPaths=s),h?(f=f.concat(this.errors.slice(e)),this.errors=this.errors.slice(0,e),this.createError(t.ANY_OF_MISSING,{},"","/anyOf",f)):void 0};n.prototype.validateOneOf=function(n,i,r){var u,l,a;if(i.oneOf===undefined)return null;var f=null,e=[],o=this.errors.length,s,h;for(this.trackUnknownProperties&&(s=this.unknownPropertyPaths,h=this.knownPropertyPaths),u=0;u<i.oneOf.length;u++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var v=i.oneOf[u],y=this.errors.length,c=this.validateAll(n,v,[],["oneOf",u],r);if(c===null&&y===this.errors.length){if(f===null)f=u;else return this.errors=this.errors.slice(0,o),this.createError(t.ONE_OF_MULTIPLE,{index1:f,index2:u},"","/oneOf");if(this.trackUnknownProperties){for(l in this.knownPropertyPaths)h[l]=!0,delete s[l];for(a in this.unknownPropertyPaths)h[a]||(s[a]=!0)}}else c&&e.push(c)}return(this.trackUnknownProperties&&(this.unknownPropertyPaths=s,this.knownPropertyPaths=h),f===null)?(e=e.concat(this.errors.slice(o)),this.errors=this.errors.slice(0,o),this.createError(t.ONE_OF_MISSING,{},"","/oneOf",e)):(this.errors=this.errors.slice(0,o),null)};n.prototype.validateNot=function(n,i,r){var u,f,e,o,s;return i.not===undefined?null:(u=this.errors.length,this.trackUnknownProperties&&(f=this.unknownPropertyPaths,e=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={}),o=this.validateAll(n,i.not,null,null,r),s=this.errors.slice(u),this.errors=this.errors.slice(0,u),this.trackUnknownProperties&&(this.unknownPropertyPaths=f,this.knownPropertyPaths=e),o===null&&s.length===0)?this.createError(t.NOT_PASSED,{},"","/not"):null};n.prototype.validateHypermedia=function(n,t,i){var h,r,e,u,o,f,c,l;if(!t.links)return null;for(r=0;r<t.links.length;r++)if(e=t.links[r],e.rel==="describedby"){for(u=new s(e.href),o=!0,f=0;f<u.varNames.length;f++)if(!(u.varNames[f]in n)){o=!1;break}if(o&&(c=u.fillFromObject(n),l={$ref:c},h=this.validateAll(n,l,[],["links",r],i)))return h}};t={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3};u={};for(y in t)u[t[y]]=y;return f={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"},r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r.prototype.name="ValidationError",r.prototype.prefixWith=function(n,t){if(n!==null&&(n=n.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+n+this.dataPath),t!==null&&(t=t.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+t+this.schemaPath),this.subErrors!==null)for(var i=0;i<this.subErrors.length;i++)this.subErrors[i].prefixWith(n,t);return this},i={},e=d(),e.addLanguage("en-gb",f),e.tv4=e,e});
//# sourceMappingURL=tv4.min.js.map
